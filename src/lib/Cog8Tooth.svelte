<script lang="ts">
  import { getContext } from 'svelte';
  import type { BaseProps, Props } from './types';

  const ctx: BaseProps = getContext('iconCtx') ?? {};

  let {
    size = ctx.size,
    role = ctx.role || 'img',
    color = ctx.color || 'currentColor',
    variation = ctx.variation || 'outline',
    strokeWidth = ctx.strokeWidth || '1.5',
    title,
    desc,
    ariaLabel = 'cog 8 tooth',
    ...restProps
  }: Props = $props();

  let ariaDescribedby = `${title?.id || ''} ${desc?.id || ''}`;
  const hasDescription = $derived(!!(title?.id || desc?.id));

  let viewBox = $derived.by(() => {
    if (variation === 'mini') return '0 0 20 20';
    if (variation === 'micro') return '0 0 16 16';
    return '0 0 24 24';
  });
  let variationSize = $derived.by(() => {
    if (variation === 'mini') return '20';
    if (variation === 'micro') return '16';
    return '24';
  });
</script>

<svg
  xmlns="http://www.w3.org/2000/svg"
  {...restProps}
  {role}
  width={size || variationSize}
  height={size || variationSize}
  fill="none"
  aria-label={ariaLabel}
  aria-describedby={hasDescription ? ariaDescribedby : undefined}
  {viewBox}
  stroke-width={strokeWidth}
>
  {#if title?.id && title.title}
    <title id={title.id}>{title.title}</title>
  {/if}
  {#if desc?.id && desc.desc}
    <desc id={desc.id}>{desc.desc}</desc>
  {/if}
  {#if variation === 'outline'}
    <path
      d="M10.3426 3.94002C10.433 3.39756 10.9024 2.99997 11.4523 2.99997H12.5463C13.0962 2.99997 13.5656 3.39756 13.656 3.94002L13.8049 4.83383C13.8757 5.2581 14.1886 5.59835 14.5858 5.76329C14.9832 5.92829 15.4396 5.90625 15.7897 5.65614L16.5273 5.1293C16.9748 4.80966 17.5878 4.86039 17.9767 5.24926L18.7503 6.02281C19.1391 6.41168 19.1899 7.02469 18.8702 7.4722L18.3432 8.21003C18.0931 8.56009 18.0711 9.0163 18.236 9.4136C18.4009 9.81075 18.7411 10.1236 19.1653 10.1943L20.0592 10.3433C20.6017 10.4337 20.9993 10.903 20.9993 11.453V12.547C20.9993 13.0969 20.6017 13.5662 20.0592 13.6566L19.1654 13.8056C18.7412 13.8763 18.4009 14.1892 18.236 14.5865C18.071 14.9839 18.093 15.4402 18.3431 15.7904L18.8699 16.5278C19.1895 16.9753 19.1388 17.5883 18.7499 17.9772L17.9764 18.7507C17.5875 19.1396 16.9745 19.1903 16.527 18.8707L15.7894 18.3438C15.4393 18.0938 14.983 18.0717 14.5857 18.2367C14.1885 18.4016 13.8757 18.7418 13.805 19.166L13.656 20.0599C13.5656 20.6024 13.0962 21 12.5463 21H11.4523C10.9024 21 10.433 20.6024 10.3426 20.0599L10.1937 19.1661C10.1229 18.7418 9.81002 18.4016 9.41278 18.2367C9.01538 18.0717 8.55905 18.0937 8.2089 18.3438L7.47128 18.8707C7.02377 19.1903 6.41076 19.1396 6.02189 18.7507L5.24834 17.9772C4.85947 17.5883 4.80874 16.9753 5.12838 16.5278L5.65542 15.7899C5.90546 15.4399 5.9275 14.9837 5.76255 14.5863C5.59767 14.1892 5.25749 13.8763 4.83332 13.8056L3.93935 13.6566C3.39689 13.5662 2.9993 13.0969 2.9993 12.547V11.453C2.9993 10.903 3.39689 10.4337 3.93935 10.3433L4.83316 10.1943C5.25743 10.1236 5.59768 9.81068 5.76262 9.41344C5.92763 9.01602 5.90559 8.55967 5.65547 8.20951L5.12878 7.47213C4.80913 7.02462 4.85986 6.41161 5.24873 6.02274L6.02228 5.24919C6.41115 4.86033 7.02416 4.80959 7.47167 5.12924L8.20927 5.65609C8.55934 5.90615 9.01558 5.92819 9.4129 5.76323C9.81007 5.59834 10.1229 5.25816 10.1936 4.83397L10.3426 3.94002Z"
      stroke={color}
      stroke-width={strokeWidth}
      stroke-linecap="round"
      stroke-linejoin="round"
    />
    <path
      d="M15 12C15 13.6568 13.6569 15 12 15C10.3431 15 9 13.6568 9 12C9 10.3431 10.3431 8.99999 12 8.99999C13.6569 8.99999 15 10.3431 15 12Z"
      stroke={color}
      stroke-width={strokeWidth}
      stroke-linecap="round"
      stroke-linejoin="round"
    />
  {:else if variation === 'mini'}
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M8.33922 1.80388C8.43271 1.33646 8.84312 1 9.3198 1H10.6802C11.1569 1 11.5673 1.33646 11.6608 1.80388L11.9553 3.27675C12.4522 3.42101 12.9263 3.61886 13.3709 3.86363L14.6212 3.03014C15.0178 2.76572 15.5459 2.81802 15.883 3.15508L16.8449 4.11702C17.182 4.45409 17.2343 4.98221 16.9699 5.37883L16.1364 6.62908C16.3811 7.07369 16.579 7.54778 16.7232 8.04465L18.1961 8.33922C18.6635 8.43271 19 8.84312 19 9.3198V10.6802C19 11.1569 18.6635 11.5673 18.1961 11.6608L16.7232 11.9553C16.579 12.4522 16.3812 12.9262 16.1364 13.3708L16.97 14.6212C17.2344 15.0178 17.1821 15.5459 16.845 15.883L15.8831 16.8449C15.546 17.182 15.0179 17.2343 14.6213 16.9699L13.371 16.1363C12.9264 16.3811 12.4522 16.579 11.9554 16.7232L11.6608 18.1961C11.5673 18.6635 11.1569 19 10.6802 19H9.3198C8.84312 19 8.43271 18.6635 8.33922 18.1961L8.04465 16.7232C7.54778 16.579 7.0737 16.3811 6.62908 16.1364L5.37882 16.9699C4.9822 17.2343 4.45408 17.182 4.11701 16.8449L3.15507 15.883C2.81801 15.5459 2.76571 15.0178 3.03013 14.6212L3.86363 13.3709C3.61886 12.9263 3.42101 12.4522 3.27675 11.9554L1.80388 11.6608C1.33646 11.5673 1 11.1569 1 10.6802L1 9.3198C1 8.84312 1.33646 8.43271 1.80388 8.33922L3.27675 8.04465C3.42102 7.54774 3.61889 7.07363 3.86368 6.62898L3.03024 5.37882C2.76582 4.9822 2.81812 4.45408 3.15518 4.11701L4.11712 3.15507C4.45419 2.81801 4.98231 2.76571 5.37893 3.03013L6.62913 3.86359C7.07373 3.61884 7.5478 3.42101 8.04465 3.27675L8.33922 1.80388ZM13 10C13 11.6569 11.6569 13 10 13C8.34315 13 7 11.6569 7 10C7 8.34315 8.34315 7 10 7C11.6569 7 13 8.34315 13 10Z"
      fill={color}
    />
  {:else if variation === 'micro'}
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M6.95498 1.45025C6.98054 1.19465 7.19562 1 7.45249 1H8.54751C8.80438 1 9.01946 1.19465 9.04502 1.45025L9.21486 3.14861C9.69862 3.26937 10.1545 3.46058 10.5709 3.71072L11.892 2.62984C12.0908 2.46717 12.3805 2.48162 12.5622 2.66326L13.3365 3.43755C13.5181 3.61919 13.5326 3.90891 13.3699 4.10772L12.2891 5.42874C12.5393 5.84526 12.7306 6.30125 12.8514 6.78514L14.5498 6.95498C14.8054 6.98054 15 7.19562 15 7.45249V8.54751C15 8.80438 14.8054 9.01946 14.5498 9.04502L12.8514 9.21486C12.7306 9.6986 12.5394 10.1544 12.2893 10.5709L13.3707 11.8925C13.5333 12.0913 13.5189 12.381 13.3372 12.5627L12.5629 13.337C12.3813 13.5186 12.0916 13.5331 11.8928 13.3704L10.5712 12.2891C10.1547 12.5393 9.69873 12.7306 9.21486 12.8514L9.04502 14.5498C9.01946 14.8054 8.80438 15 8.54751 15H7.45249C7.19562 15 6.98054 14.8054 6.95498 14.5498L6.78514 12.8514C6.30138 12.7306 5.84551 12.5394 5.42907 12.2893L4.10799 13.3702C3.90917 13.5328 3.61945 13.5184 3.43781 13.3367L2.66352 12.5624C2.48188 12.3808 2.46743 12.0911 2.6301 11.8923L3.71093 10.5713C3.46068 10.1547 3.2694 9.69875 3.14861 9.21486L1.45025 9.04502C1.19465 9.01946 1 8.80438 1 8.54751V7.45249C1 7.19562 1.19465 6.98054 1.45025 6.95498L3.14861 6.78514C3.26936 6.3014 3.46056 5.84555 3.71069 5.42913L2.62935 4.1075C2.46668 3.90869 2.48113 3.61896 2.66277 3.43733L3.43706 2.66303C3.6187 2.4814 3.90842 2.46695 4.10724 2.62961L5.4288 3.71089C5.84531 3.46066 6.30127 3.26939 6.78514 3.14861L6.95498 1.45025ZM6 8C6 8.53781 6.21228 9.02604 6.55761 9.38547L6.61453 9.44239C6.97396 9.78772 7.46219 10 8 10C9.10457 10 10 9.10457 10 8C10 7.46219 9.78772 6.97396 9.44239 6.61453L9.38547 6.55761C9.02604 6.21228 8.53781 6 8 6C6.89543 6 6 6.89543 6 8Z"
      fill={color}
    />
  {:else}
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M11.828 2.25C10.9115 2.25 10.1292 2.91265 9.97854 3.81675L9.88699 4.36602C9.84017 4.64695 9.63707 4.87407 9.37035 4.97395C9.20811 5.0347 9.04853 5.1009 8.89184 5.17235C8.63259 5.29056 8.32822 5.27363 8.09636 5.10801L7.64299 4.78418C6.89714 4.25143 5.87546 4.33599 5.22734 4.9841L4.98413 5.22732C4.33601 5.87544 4.25145 6.89712 4.7842 7.64297L5.10803 8.09633C5.27364 8.32819 5.29057 8.63256 5.17236 8.89182C5.10091 9.04851 5.0347 9.20809 4.97395 9.37034C4.87408 9.63706 4.64695 9.84016 4.36602 9.88698L3.81675 9.97852C2.91265 10.1292 2.25 10.9114 2.25 11.828V12.172C2.25 13.0885 2.91265 13.8708 3.81675 14.0215L4.36602 14.113C4.64695 14.1598 4.87407 14.3629 4.97395 14.6297C5.03469 14.7919 5.1009 14.9515 5.17234 15.1082C5.29056 15.3674 5.27362 15.6718 5.10801 15.9036L4.78416 16.357C4.25141 17.1029 4.33597 18.1246 4.98408 18.7727L5.2273 19.0159C5.87541 19.664 6.8971 19.7486 7.64295 19.2158L8.09633 18.892C8.32819 18.7264 8.63256 18.7094 8.89182 18.8276C9.04851 18.8991 9.20809 18.9653 9.37034 19.026C9.63706 19.1259 9.84016 19.353 9.88698 19.634L9.97852 20.1832C10.1292 21.0873 10.9114 21.75 11.828 21.75H12.172C13.0885 21.75 13.8708 21.0874 14.0215 20.1832L14.113 19.634C14.1598 19.3531 14.3629 19.1259 14.6297 19.0261C14.7919 18.9653 14.9515 18.8991 15.1082 18.8277C15.3674 18.7094 15.6718 18.7264 15.9036 18.892L16.357 19.2158C17.1029 19.7486 18.1245 19.664 18.7727 19.0159L19.0159 18.7727C19.664 18.1246 19.7485 17.1029 19.2158 16.357L18.892 15.9037C18.7264 15.6718 18.7094 15.3674 18.8276 15.1082C18.8991 14.9515 18.9653 14.7919 19.026 14.6297C19.1259 14.3629 19.353 14.1598 19.634 14.113L20.1832 14.0215C21.0873 13.8708 21.75 13.0886 21.75 12.172V11.828C21.75 10.9115 21.0874 10.1292 20.1832 9.97854L19.634 9.88699C19.3531 9.84017 19.1259 9.63707 19.0261 9.37035C18.9653 9.20811 18.8991 9.04854 18.8277 8.89185C18.7094 8.63259 18.7264 8.32822 18.892 8.09636L19.2158 7.64297C19.7486 6.89712 19.664 5.87544 19.0159 5.22732L18.7727 4.9841C18.1246 4.33599 17.1029 4.25143 16.3571 4.78418L15.9037 5.10802C15.6718 5.27364 15.3674 5.29057 15.1082 5.17236C14.9515 5.10091 14.7919 5.0347 14.6297 4.97395C14.3629 4.87408 14.1598 4.64695 14.113 4.36602L14.0215 3.81675C13.8708 2.91265 13.0886 2.25 12.172 2.25H11.828ZM12 15.75C14.0711 15.75 15.75 14.0711 15.75 12C15.75 9.92893 14.0711 8.25 12 8.25C9.92893 8.25 8.25 9.92893 8.25 12C8.25 14.0711 9.92893 15.75 12 15.75Z"
      fill={color}
    />
  {/if}
</svg>
