<script lang="ts">
  import { getContext } from 'svelte';

  type TitleType = {
    id?: string;
    title?: string;
  };
  
  type DescType = {
    id?: string;
    desc?: string;
  };
  
  interface BaseProps {
    size?: string;
    role?: string;
    color?: string;
    variation?: "solid" | "outline" | "mini" | "micro";
    strokeWidth?: string;
    withEvents?: boolean;
    onclick?: (event: MouseEvent) => void;
    onkeydown?: (event: KeyboardEvent) => void;
    onkeyup?: (event: KeyboardEvent) => void;
    class?: string;
  }
  
  interface CtxType extends BaseProps {}
  
  interface Props extends BaseProps{
    title?: TitleType;
    desc?: DescType;
    ariaLabel?: string;
  }
  
  const ctx: CtxType = getContext('iconCtx') ?? {};

  let { 
    size = ctx.size || '24', 
    role = ctx.role || 'img', 
    color = ctx.color || 'currentColor', 
    variation = ctx.variation || "outline",
    strokeWidth = ctx.strokeWidth || '1.5',
    withEvents = ctx.withEvents || false, 
    title = {}, 
    desc = {}, 
    class: classname, 
    ariaLabel = "signal slash", 
    onclick, 
    onkeydown, 
    onkeyup,
    ...restProps 
  }: Props = $props();

  let ariaDescribedby = `${title.id || ''} ${desc.id || ''}`;
  let hasDescription = $state(false);
  let viewBox: string = $state(''); 

  function updateHasDescription() {
    hasDescription = !!(title.id || desc.id); 
  }
  updateHasDescription();

  $effect(() => {
    updateHasDescription();
 
    if (variation === 'mini') {
      size = size || "20";
      viewBox = '0 0 20 20';
    } else if (variation === 'micro'){
      size = size || "16";
      viewBox = '0 0 16 16';
    } else {
      size = size || "24";
      viewBox = '0 0 24 24';
    }
  })
  
</script>

{#if withEvents}
  <svg
    xmlns="http://www.w3.org/2000/svg"
    {...restProps}
    {role}
    width={size}
    height={size}
    class={classname}
    fill="none"
    aria-label={ariaLabel}
    aria-describedby={hasDescription ? ariaDescribedby : undefined}
    {viewBox}
    stroke-width={strokeWidth}
    onclick={onclick}
    onkeydown={onkeydown}
    onkeyup={onkeyup}
  >
    {#if title.id && title.title}
      <title id="{title.id}">{title.title}</title>
    {/if}
    {#if desc.id && desc.desc}
      <desc id="{desc.id}">{desc.desc}</desc>
    {/if}
      {#if variation === 'outline'}
        <path d="M3 3L11.7348 11.7348M11.7348 11.7348C11.8027 11.667 11.8964 11.625 12 11.625C12.2071 11.625 12.375 11.7929 12.375 12C12.375 12.1036 12.333 12.1973 12.2652 12.2652M11.7348 11.7348L12.2652 12.2652M12.2652 12.2652L21 21M14.6517 9.34835C16.1161 10.8128 16.1161 13.1872 14.6517 14.6516M16.773 7.22703C19.409 9.86307 19.409 14.1369 16.773 16.773M18.8943 5.10571C22.7019 8.91332 22.7019 15.0867 18.8943 18.8943M9.34835 14.6516C8.75129 14.0546 8.39765 13.3063 8.28743 12.5301M7.22703 16.773C5.35299 14.8989 4.81126 12.1971 5.60184 9.84448M5.10571 18.8943C2.03824 15.8268 1.44197 11.2239 3.3169 7.55955M12 12H12.0075V12.0075H12V12Z" stroke="{color}" stroke-width="{strokeWidth}" stroke-linecap="round" stroke-linejoin="round"/> 
      {:else if variation === 'mini'}
        <path d="M2.21967 2.21967C2.51256 1.92678 2.98744 1.92678 3.28033 2.21967L10.0626 9.00193C10.565 9.03295 10.967 9.43498 10.9981 9.93741L17.7803 16.7197C18.0732 17.0126 18.0732 17.4874 17.7803 17.7803C17.4874 18.0732 17.0126 18.0732 16.7197 17.7803L9.93741 10.9981C9.43498 10.967 9.03295 10.565 9.00193 10.0626L2.21967 3.28033C1.92678 2.98744 1.92678 2.51256 2.21967 2.21967Z" fill="{color}"/> <path d="M3.63604 16.364C0.670686 13.3986 0.207189 8.87882 2.24555 5.42753L3.3485 6.53048C1.87267 9.35787 2.32207 12.9287 4.6967 15.3033C4.98959 15.5962 4.98959 16.0711 4.6967 16.364C4.40381 16.6569 3.92893 16.6569 3.63604 16.364Z" fill="{color}"/> <path d="M6.46447 13.5356C5.08411 12.1552 4.67956 10.1685 5.25082 8.43281L6.51322 9.6952C6.4268 10.6896 6.76411 11.7139 7.52513 12.4749C7.81802 12.7678 7.81802 13.2427 7.52513 13.5356C7.23223 13.8284 6.75736 13.8284 6.46447 13.5356Z" fill="{color}"/> <path d="M16.364 3.63605C19.3293 6.6014 19.7928 11.1212 17.7545 14.5725L16.6515 13.4695C18.1273 10.6421 17.6779 7.07134 15.3033 4.69671C15.0104 4.40382 15.0104 3.92895 15.3033 3.63605C15.5962 3.34316 16.0711 3.34316 16.364 3.63605Z" fill="{color}"/> <path d="M13.5355 6.46449C14.9159 7.84484 15.3204 9.83147 14.7492 11.5672L13.4868 10.3048C13.5732 9.31043 13.2359 8.28616 12.4749 7.52515C12.182 7.23225 12.182 6.75738 12.4749 6.46449C12.7678 6.17159 13.2426 6.17159 13.5355 6.46449Z" fill="{color}"/> 
      {:else if variation === 'micro'}
        <path d="M3.28033 2.21967C2.98744 1.92678 2.51256 1.92678 2.21967 2.21967C1.92678 2.51256 1.92678 2.98744 2.21967 3.28033L7.00193 8.06259C7.03295 8.56502 7.43498 8.96705 7.93741 8.99807L12.7197 13.7803C13.0126 14.0732 13.4874 14.0732 13.7803 13.7803C14.0732 13.4874 14.0732 13.0126 13.7803 12.7197L8.99807 7.93741C8.96705 7.43498 8.56502 7.03295 8.06259 7.00193L3.28033 2.21967Z" fill="{color}"/> <path d="M3.05025 12.9502C0.873058 10.773 0.42986 7.51846 1.72066 4.90264L2.85932 6.0413C2.11257 8.00408 2.52977 10.3084 4.11091 11.8896C4.40381 12.1825 4.40381 12.6573 4.11091 12.9502C3.81802 13.2431 3.34315 13.2431 3.05025 12.9502Z" fill="{color}"/> <path d="M5.25996 10.74C4.33993 9.82 3.97925 8.55243 4.17793 7.35991L5.86994 9.05192C5.98183 9.27844 6.13206 9.49082 6.32062 9.67938C6.61351 9.97227 6.61351 10.4471 6.32062 10.74C6.02773 11.0329 5.55285 11.0329 5.25996 10.74Z" fill="{color}"/> <path d="M12.9497 3.05072C15.1268 5.22774 15.5701 8.48196 14.2797 11.0977L13.1409 9.95896C13.8873 7.99633 13.4701 5.69235 11.8891 4.11138C11.5962 3.81849 11.5962 3.34362 11.8891 3.05072C12.182 2.75783 12.6569 2.75783 12.9497 3.05072Z" fill="{color}"/> <path d="M10.74 5.25996C11.6601 6.18 12.0208 7.44757 11.8221 8.64009L10.1301 6.94808C10.0182 6.72156 9.86794 6.50918 9.67938 6.32062C9.38649 6.02773 9.38649 5.55285 9.67938 5.25996C9.97227 4.96707 10.4471 4.96707 10.74 5.25996Z" fill="{color}"/> 
      {:else}
        <path fill-rule="evenodd" clip-rule="evenodd" d="M2.46968 2.46967C2.76257 2.17678 3.23744 2.17678 3.53034 2.46967L11.9374 10.8767C11.9581 10.8756 11.979 10.875 12 10.875C12.6213 10.875 13.125 11.3787 13.125 12C13.125 12.021 13.1244 12.0419 13.1233 12.0626L14.5848 13.5242C15.2643 12.3737 15.1098 10.8671 14.1213 9.87868C13.8284 9.58579 13.8284 9.11091 14.1213 8.81802C14.4142 8.52513 14.8891 8.52513 15.182 8.81802C16.7587 10.3947 16.9208 12.8503 15.6683 14.6077L16.7402 15.6795C18.572 13.3257 18.4062 9.9209 16.2426 7.75736C15.9498 7.46447 15.9498 6.98959 16.2426 6.6967C16.5355 6.40381 17.0104 6.40381 17.3033 6.6967C20.0533 9.44664 20.2213 13.8008 17.8075 16.7468L18.8725 17.8118C21.8696 14.2758 21.7001 8.97217 18.364 5.63604C18.0711 5.34315 18.0711 4.86827 18.364 4.57538C18.6569 4.28249 19.1317 4.28249 19.4246 4.57538C23.3468 8.49757 23.5174 14.7507 19.9363 18.8756L21.5303 20.4697C21.8232 20.7626 21.8232 21.2374 21.5303 21.5303C21.2374 21.8232 20.7626 21.8232 20.4697 21.5303L18.3644 19.4251L16.2426 17.3033L16.242 17.3027L11.5366 12.5972C11.4896 12.5603 11.4472 12.5179 11.4103 12.4709L2.46968 3.53033C2.17678 3.23744 2.17678 2.76256 2.46968 2.46967ZM3.65854 6.89187C4.02729 7.08054 4.17326 7.53242 3.98459 7.90117C2.25352 11.2844 2.80534 15.5333 5.63605 18.364C5.92894 18.6569 5.92894 19.1317 5.63605 19.4246C5.34315 19.7175 4.86828 19.7175 4.57539 19.4246C1.27115 16.1204 0.630437 11.1635 2.64924 7.21792C2.83791 6.84917 3.28979 6.70319 3.65854 6.89187ZM5.84076 9.13355C6.23339 9.2655 6.44473 9.69075 6.31278 10.0834C5.6094 12.1765 6.09233 14.5776 7.75737 16.2426C8.05026 16.5355 8.05026 17.0104 7.75737 17.3033C7.46447 17.5962 6.9896 17.5962 6.69671 17.3033C4.61367 15.2203 4.01314 12.2177 4.89092 9.60558C5.02286 9.21294 5.44812 9.00161 5.84076 9.13355ZM8.182 11.7875C8.5921 11.7293 8.97176 12.0145 9.02999 12.4246C9.11816 13.0455 9.40043 13.6431 9.87869 14.1213C10.1716 14.4142 10.1716 14.8891 9.87869 15.182C9.58579 15.4749 9.11092 15.4749 8.81803 15.182C8.10217 14.4661 7.67717 13.5671 7.54489 12.6355C7.48666 12.2254 7.7719 11.8458 8.182 11.7875Z" fill="{color}"/> 
      {/if}
  </svg>
{:else}
  <svg
    xmlns="http://www.w3.org/2000/svg"
    {...restProps}
    {role}
    width={size}
    height={size}
    class={classname}
    fill="none"
    aria-label={ariaLabel}
    aria-describedby={hasDescription ? ariaDescribedby : undefined}
    {viewBox}
    stroke-width={strokeWidth}
  >
    {#if title.id && title.title}
      <title id="{title.id}">{title.title}</title>
    {/if}
    {#if desc.id && desc.desc}
      <desc id="{desc.id}">{desc.desc}</desc>
    {/if}
      {#if variation === 'outline'}
        <path d="M3 3L11.7348 11.7348M11.7348 11.7348C11.8027 11.667 11.8964 11.625 12 11.625C12.2071 11.625 12.375 11.7929 12.375 12C12.375 12.1036 12.333 12.1973 12.2652 12.2652M11.7348 11.7348L12.2652 12.2652M12.2652 12.2652L21 21M14.6517 9.34835C16.1161 10.8128 16.1161 13.1872 14.6517 14.6516M16.773 7.22703C19.409 9.86307 19.409 14.1369 16.773 16.773M18.8943 5.10571C22.7019 8.91332 22.7019 15.0867 18.8943 18.8943M9.34835 14.6516C8.75129 14.0546 8.39765 13.3063 8.28743 12.5301M7.22703 16.773C5.35299 14.8989 4.81126 12.1971 5.60184 9.84448M5.10571 18.8943C2.03824 15.8268 1.44197 11.2239 3.3169 7.55955M12 12H12.0075V12.0075H12V12Z" stroke="{color}" stroke-width="{strokeWidth}" stroke-linecap="round" stroke-linejoin="round"/> 
      {:else if variation === 'mini'}
        <path d="M2.21967 2.21967C2.51256 1.92678 2.98744 1.92678 3.28033 2.21967L10.0626 9.00193C10.565 9.03295 10.967 9.43498 10.9981 9.93741L17.7803 16.7197C18.0732 17.0126 18.0732 17.4874 17.7803 17.7803C17.4874 18.0732 17.0126 18.0732 16.7197 17.7803L9.93741 10.9981C9.43498 10.967 9.03295 10.565 9.00193 10.0626L2.21967 3.28033C1.92678 2.98744 1.92678 2.51256 2.21967 2.21967Z" fill="{color}"/> <path d="M3.63604 16.364C0.670686 13.3986 0.207189 8.87882 2.24555 5.42753L3.3485 6.53048C1.87267 9.35787 2.32207 12.9287 4.6967 15.3033C4.98959 15.5962 4.98959 16.0711 4.6967 16.364C4.40381 16.6569 3.92893 16.6569 3.63604 16.364Z" fill="{color}"/> <path d="M6.46447 13.5356C5.08411 12.1552 4.67956 10.1685 5.25082 8.43281L6.51322 9.6952C6.4268 10.6896 6.76411 11.7139 7.52513 12.4749C7.81802 12.7678 7.81802 13.2427 7.52513 13.5356C7.23223 13.8284 6.75736 13.8284 6.46447 13.5356Z" fill="{color}"/> <path d="M16.364 3.63605C19.3293 6.6014 19.7928 11.1212 17.7545 14.5725L16.6515 13.4695C18.1273 10.6421 17.6779 7.07134 15.3033 4.69671C15.0104 4.40382 15.0104 3.92895 15.3033 3.63605C15.5962 3.34316 16.0711 3.34316 16.364 3.63605Z" fill="{color}"/> <path d="M13.5355 6.46449C14.9159 7.84484 15.3204 9.83147 14.7492 11.5672L13.4868 10.3048C13.5732 9.31043 13.2359 8.28616 12.4749 7.52515C12.182 7.23225 12.182 6.75738 12.4749 6.46449C12.7678 6.17159 13.2426 6.17159 13.5355 6.46449Z" fill="{color}"/> 
      {:else if variation === 'micro'}
        <path d="M3.28033 2.21967C2.98744 1.92678 2.51256 1.92678 2.21967 2.21967C1.92678 2.51256 1.92678 2.98744 2.21967 3.28033L7.00193 8.06259C7.03295 8.56502 7.43498 8.96705 7.93741 8.99807L12.7197 13.7803C13.0126 14.0732 13.4874 14.0732 13.7803 13.7803C14.0732 13.4874 14.0732 13.0126 13.7803 12.7197L8.99807 7.93741C8.96705 7.43498 8.56502 7.03295 8.06259 7.00193L3.28033 2.21967Z" fill="{color}"/> <path d="M3.05025 12.9502C0.873058 10.773 0.42986 7.51846 1.72066 4.90264L2.85932 6.0413C2.11257 8.00408 2.52977 10.3084 4.11091 11.8896C4.40381 12.1825 4.40381 12.6573 4.11091 12.9502C3.81802 13.2431 3.34315 13.2431 3.05025 12.9502Z" fill="{color}"/> <path d="M5.25996 10.74C4.33993 9.82 3.97925 8.55243 4.17793 7.35991L5.86994 9.05192C5.98183 9.27844 6.13206 9.49082 6.32062 9.67938C6.61351 9.97227 6.61351 10.4471 6.32062 10.74C6.02773 11.0329 5.55285 11.0329 5.25996 10.74Z" fill="{color}"/> <path d="M12.9497 3.05072C15.1268 5.22774 15.5701 8.48196 14.2797 11.0977L13.1409 9.95896C13.8873 7.99633 13.4701 5.69235 11.8891 4.11138C11.5962 3.81849 11.5962 3.34362 11.8891 3.05072C12.182 2.75783 12.6569 2.75783 12.9497 3.05072Z" fill="{color}"/> <path d="M10.74 5.25996C11.6601 6.18 12.0208 7.44757 11.8221 8.64009L10.1301 6.94808C10.0182 6.72156 9.86794 6.50918 9.67938 6.32062C9.38649 6.02773 9.38649 5.55285 9.67938 5.25996C9.97227 4.96707 10.4471 4.96707 10.74 5.25996Z" fill="{color}"/> 
      {:else}
        <path fill-rule="evenodd" clip-rule="evenodd" d="M2.46968 2.46967C2.76257 2.17678 3.23744 2.17678 3.53034 2.46967L11.9374 10.8767C11.9581 10.8756 11.979 10.875 12 10.875C12.6213 10.875 13.125 11.3787 13.125 12C13.125 12.021 13.1244 12.0419 13.1233 12.0626L14.5848 13.5242C15.2643 12.3737 15.1098 10.8671 14.1213 9.87868C13.8284 9.58579 13.8284 9.11091 14.1213 8.81802C14.4142 8.52513 14.8891 8.52513 15.182 8.81802C16.7587 10.3947 16.9208 12.8503 15.6683 14.6077L16.7402 15.6795C18.572 13.3257 18.4062 9.9209 16.2426 7.75736C15.9498 7.46447 15.9498 6.98959 16.2426 6.6967C16.5355 6.40381 17.0104 6.40381 17.3033 6.6967C20.0533 9.44664 20.2213 13.8008 17.8075 16.7468L18.8725 17.8118C21.8696 14.2758 21.7001 8.97217 18.364 5.63604C18.0711 5.34315 18.0711 4.86827 18.364 4.57538C18.6569 4.28249 19.1317 4.28249 19.4246 4.57538C23.3468 8.49757 23.5174 14.7507 19.9363 18.8756L21.5303 20.4697C21.8232 20.7626 21.8232 21.2374 21.5303 21.5303C21.2374 21.8232 20.7626 21.8232 20.4697 21.5303L18.3644 19.4251L16.2426 17.3033L16.242 17.3027L11.5366 12.5972C11.4896 12.5603 11.4472 12.5179 11.4103 12.4709L2.46968 3.53033C2.17678 3.23744 2.17678 2.76256 2.46968 2.46967ZM3.65854 6.89187C4.02729 7.08054 4.17326 7.53242 3.98459 7.90117C2.25352 11.2844 2.80534 15.5333 5.63605 18.364C5.92894 18.6569 5.92894 19.1317 5.63605 19.4246C5.34315 19.7175 4.86828 19.7175 4.57539 19.4246C1.27115 16.1204 0.630437 11.1635 2.64924 7.21792C2.83791 6.84917 3.28979 6.70319 3.65854 6.89187ZM5.84076 9.13355C6.23339 9.2655 6.44473 9.69075 6.31278 10.0834C5.6094 12.1765 6.09233 14.5776 7.75737 16.2426C8.05026 16.5355 8.05026 17.0104 7.75737 17.3033C7.46447 17.5962 6.9896 17.5962 6.69671 17.3033C4.61367 15.2203 4.01314 12.2177 4.89092 9.60558C5.02286 9.21294 5.44812 9.00161 5.84076 9.13355ZM8.182 11.7875C8.5921 11.7293 8.97176 12.0145 9.02999 12.4246C9.11816 13.0455 9.40043 13.6431 9.87869 14.1213C10.1716 14.4142 10.1716 14.8891 9.87869 15.182C9.58579 15.4749 9.11092 15.4749 8.81803 15.182C8.10217 14.4661 7.67717 13.5671 7.54489 12.6355C7.48666 12.2254 7.7719 11.8458 8.182 11.7875Z" fill="{color}"/> 
      {/if}
  </svg>
{/if}


